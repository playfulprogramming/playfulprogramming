---
import { SnitipMetadata } from "types/SnitipInfo";
import style from "./snitip.module.scss";
import { Icon } from "astro-icon/components";

interface Props {
	snitips: Map<string, SnitipMetadata>;
}

const snitips = Astro.props.snitips;
---

{
	[...snitips.entries()].map(([id, snitip]) => (
		<div id={`snitip-popover-${id}`} popover class={style.popover} tabindex="0">
			<svg
				id="snitip-arrow"
				width="24"
				height="14"
				viewBox="0 0 24 14"
				fill="none"
				class={style.arrow}
				data-placement="bottom"
			>
				<path
					d="M 2 -1 L 11.2 11.6 C 11.6 12.1333 12.4 12.1333 12.8 11.6 L 22 -1 Z"
					fill="var(--snitip_background-color)"
				/>
				<path
					d="M 2 -1 L 11.2 11.6 C 11.6 12.1333 12.4 12.1333 12.8 11.6 L 22 -1"
					stroke="var(--snitip_border-color)"
					stroke-width="var(--snitip_border-width)"
				/>
			</svg>
			<div class={style.container}>
				<h1 class={style.title}>{snitip.title}</h1>
				<div class={style.description} set:html={snitip.content} />
				<ul class={style.links}>
					{snitip.links.map((link) => (
						<li>
							<a class={`${style.links__item} a`} href={link.href}>
								<Icon width={18} height={18} name="link" />
								{link.name}
							</a>
						</li>
					))}
				</ul>
			</div>
		</div>
	))
}

<script>
	import "./snitip-script-impl";
</script>
